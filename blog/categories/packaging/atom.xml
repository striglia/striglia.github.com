<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: packaging | Locally Optimal]]></title>
  <link href="http://striglia.github.com/blog/categories/packaging/atom.xml" rel="self"/>
  <link href="http://striglia.github.com/"/>
  <updated>2016-06-04T17:27:34-07:00</updated>
  <id>http://striglia.github.com/</id>
  <author>
    <name><![CDATA[Scott Triglia]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Executable python scripts via entry points]]></title>
    <link href="http://striglia.github.com/blog/2014/03/14/executable-python-scripts-via-entry-points/"/>
    <updated>2014-03-14T16:11:00-07:00</updated>
    <id>http://striglia.github.com/blog/2014/03/14/executable-python-scripts-via-entry-points</id>
    <content type="html"><![CDATA[<p>A quick topic -- executing a python module from the command line!</p>

<!-- more -->


<p>When <a href="http://locallyoptimal.com/blog/2014/03/14/building-a-basic-package-pt-1-bare-bones/">I last left</a> my pet rss2sms project, it had been transformed into a basic python package. Unfortunately, this means that my old method of running <code>python rss2sms.py --foobar</code> from the command line is not so simple anymore. In fact what I really want is to be able to just run <code>rss2sms --foobar</code> from the command line after I install the package.</p>

<p>Luckily python has exactly what we need in the form of setuptools's <a href="http://pythonhosted.org//setuptools/setuptools.html#automatic-script-creation">console_script argument to entry_points</a>.</p>

<p>Let's go ahead and add it to our setup.py:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">setup</span><span class="p">(</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;rss2sms&quot;</span><span class="p">,</span>
</span><span class='line'><span class="n">version</span><span class="o">=</span><span class="n">find_version</span><span class="p">(</span><span class="s">&#39;rss2sms&#39;</span><span class="p">,</span> <span class="s">&#39;__init__.py&#39;</span><span class="p">),</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;...</span><span class="n">the</span> <span class="n">rest</span> <span class="n">of</span> <span class="n">our</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">here</span><span class="o">....&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
</span><span class='line'>    <span class="s">&#39;console_scripts&#39;</span><span class="p">:</span> <span class="p">[</span>
</span><span class='line'>        <span class="s">&#39;rss2sms=rss2sms:main&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="p">],</span>
</span><span class='line'><span class="p">},</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>So simple! Note that we're linking the executable <code>rss2sms</code> here to running the python function <code>main</code> in the <code>rss2sms</code> module. If we look at that function, it just does the normal command line parsing and function calling that it always has.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">def</span> <span class="nf">main</span><span class="p">():</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">parser</span> <span class="o">=</span> <span class="n">OptionParser</span><span class="p">()</span>
</span><span class='line'><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-u&quot;</span><span class="p">,</span> <span class="s">&quot;--url&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;rss_url&quot;</span><span class="p">,</span>
</span><span class='line'>                        <span class="n">help</span><span class="o">=</span><span class="s">&quot;url of rss feed&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-t&quot;</span><span class="p">,</span> <span class="s">&quot;--to&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;to_num&quot;</span><span class="p">,</span>
</span><span class='line'>                        <span class="n">help</span><span class="o">=</span><span class="s">&quot;cell number to send sms alerts to&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-f&quot;</span><span class="p">,</span> <span class="s">&quot;--from&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;from_num&quot;</span><span class="p">,</span>
</span><span class='line'>                        <span class="n">help</span><span class="o">=</span><span class="s">&quot;cell number to send sms alerts to (overrides environment variable TWILIO_NUMBER)&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-i&quot;</span><span class="p">,</span> <span class="s">&quot;--id&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;rss_id_field&quot;</span><span class="p">,</span>
</span><span class='line'>                        <span class="n">help</span><span class="o">=</span><span class="s">&quot;unique id rss field used for display in SMS and for equality comparison (defaults to &#39;link&#39;)&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-d&quot;</span><span class="p">,</span> <span class="s">&quot;--display&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;rss_display_field&quot;</span><span class="p">,</span>
</span><span class='line'>                        <span class="n">help</span><span class="o">=</span><span class="s">&quot;name of rss field used for display in SMS (defaults to &#39;title&#39;)&quot;</span><span class="p">)</span>
</span><span class='line'><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&quot;-c&quot;</span><span class="p">,</span> <span class="s">&quot;--cache-filename&quot;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s">&quot;cache_filename&quot;</span><span class="p">,</span>
</span><span class='line'>                        <span class="n">help</span><span class="o">=</span><span class="s">&quot;optional file to cache last post in&quot;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span><span class='line'><span class="n">rss2sms</span> <span class="o">=</span> <span class="n">Rss2Sms</span><span class="p">(</span><span class="o">**</span><span class="nb">vars</span><span class="p">(</span><span class="n">options</span><span class="p">))</span>
</span><span class='line'><span class="n">rss2sms</span><span class="o">.</span><span class="n">parse_and_alert</span><span class="p">()</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Now let's start up a fresh virtualenv and test it out. We can use pip's develop option to install a package by just passing it a path.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>~/Desktop/github/rss2sms (master) $ virtualenv entry_point_test; source entry_point_test/bin/activate
</span><span class='line'>New python executable in entry_point_test/bin/python
</span><span class='line'>Installing Setuptools..............................................................................................................................................................................................................................done.
</span><span class='line'>Installing Pip.....................................................................................................................................................................................................................................................................................................................................done.
</span><span class='line'>(entry_point_test) ~/Desktop/github/rss2sms (master) $ pip install -e .&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>... lots of text from installation...&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>(entry_point_test) ~/Desktop/github/rss2sms (master) $ rss2sms --help
</span><span class='line'>Usage: rss2sms [options]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Options:
</span><span class='line'>  -h, --help            show this help message and exit
</span><span class='line'>  -u RSS_URL, --url=RSS_URL&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>                    url of rss feed
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  -t TO_NUM, --to=TO_NUM&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>                    cell number to send sms alerts to
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  -f FROM_NUM, --from=FROM_NUM&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>                    cell number to send sms alerts to (overrides
</span><span class='line'>                    environment variable TWILIO_NUMBER)
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  -i RSS_ID_FIELD, --id=RSS_ID_FIELD&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>                    unique id rss field used for display in SMS and for
</span><span class='line'>                    equality comparison (defaults to 'link')
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  -d RSS_DISPLAY_FIELD, --display=RSS_DISPLAY_FIELD&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>                    name of rss field used for display in SMS (defaults to
</span><span class='line'>                    'title')
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>  -c CACHE_FILENAME, --cache-filename=CACHE_FILENAME&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>                    optional file to cache last post in
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>And just like that we have an executable hooked up our python module. We can even use which to see how it works:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(entry_point_test) ~/Desktop/github/rss2sms (master) $ which rss2sms
</span><span class='line'>/Users/striglia/Desktop/github/rss2sms/entry_point_test/bin/rss2sms
</span><span class='line'>(entry_point_test) ~/Desktop/github/rss2sms (master) $ cat &lt;code>which rss2sms&lt;/code>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>!/Users/striglia/Desktop/github/rss2sms/entry_point_test/bin/python&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>EASY-INSTALL-ENTRY-SCRIPT: 'rss2sms==0.0.1','console_scripts','rss2sms'&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>&lt;strong>requires&lt;/strong> = 'rss2sms==0.0.1'                                               &lt;br/>
</span><span class='line'>import sys                                                                    &lt;br/>
</span><span class='line'>from pkg_resources import load_entry_point&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>if &lt;strong>name&lt;/strong> == '&lt;strong>main&lt;/strong>':&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>sys.exit(                                                                   
</span><span class='line'>    load_entry_point('rss2sms==0.0.1', 'console_scripts', 'rss2sms')()         
</span><span class='line'>)  
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>This executable is just a simple python module which, when we call it, uses the pkg_resources library to look up what python module our setup.py says we should call. All in all, a very painless way to distribute nice executables for your library.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Building a basic package pt. 1: Bare Bones]]></title>
    <link href="http://striglia.github.com/blog/2014/03/14/building-a-basic-package-pt-1-bare-bones/"/>
    <updated>2014-03-14T13:44:00-07:00</updated>
    <id>http://striglia.github.com/blog/2014/03/14/building-a-basic-package-pt-1-bare-bones</id>
    <content type="html"><![CDATA[<p>Every once in a while I get the itch to turn some one off script I wrote into a proper package. Turns out advice on the subject is a little scattered, and if you're anything like me it can be frustrating to track down relevant posts on the entire subject. So, just for fun, let's walk through the process of taking a one-off script I wrote and making it into a nice python package, complete with isolated testing, uploading to pypi, and convenient installation.</p>

<p>Now knowing my blogging habits, I'm splitting this into a few small posts in the hopes that I actually get through them. So lets take a current project I have and decide where to start.</p>

<!-- more -->


<h2>rss2sms - a humble beginning</h2>

<p>The project I'd like to fix up is called rss2sms and lives <a href="http://www.github.com/striglia/rss2sms">on my github account</a>. I originally started it back when I was house hunting in San Francisco and was getting tired of new apartments going up on Craigslist without me noticing. So I figured it was time to automate this!</p>

<p>The code is pretty simple. At its core, it does the following steps whenever it is run:</p>

<ol>
<li>Reads a passed RSS feed into memory (e.g. a Craigslist search)</li>
<li>Loads the timestamp of the last post we were notified about from file</li>
<li>Sends a text for each post newer than the timestamp to a specified number</li>
</ol>


<p>As a result of being fairly simple, I just threw the whole thing in one python module. In fact, I threw it in one big class! I want to clean up the implementation a little as we go on, but for now let's focus on the task of turning this into a package.</p>

<h2>Structure</h2>

<p>One of the easiest steps we can take toward making a package is to imitate the proper directory structure. The kind folks over at the Python Packaging Authority (aka pypa) have <a href="http://python-packaging-user-guide.readthedocs.org/en/latest/index.html">assembled a user guide</a> for fellow travelers on the road to packaging nirvana. Unfortunately, it is very much a work in progress and a little thin on details in my opinion.</p>

<p>As a result, we'll mostly be mimicking the pypa's sample project, <a href="https://github.com/pypa/sampleproject">found on their github</a>. Let's compare our current project's structure against that.</p>

<p>rss2sms:</p>

<p><code>
- .gitignore
- README.md
- rss2sms.py
</code></p>

<p>pypa's sample project:</p>

<p><code>
- sample/
- tests/
- .gitignore
- README.md
- DESCRIPTION.rst
- MANIFEST.in
- setup.py
- setup.cfg
</code></p>

<p>Well...looks like we need some changes. Let's walk through a couple of these and explain what they're doing.</p>

<p>The most noticeable feature of a python package is the package directory. It will hold all the code necessary to run our package once it's installed. Let's start there and simply move our main module inside a directory named after the project. And just for fun, let's make a stub test directory that we can fill in properly later on.</p>

<p>```
 ~/Desktop/github/rss2sms (master) $ st
On branch master
Your branch is up-to-date with 'origin/master'.</p>

<p>Changes to be committed:
  (use "git reset HEAD <file>..." to unstage)</p>

<pre><code>renamed:    rss2sms.py -&gt; rss2sms/__init__.py
new file:   tests/__init__.py
</code></pre>

<p>```</p>

<p>Perfect. Now comparing to the sample package, the only remaining requirement is a <code>setup.py</code> module to tell python the basic details about our package.</p>

<h2>setup.py</h2>

<p>As you may be aware, the history of python packaging is not particularly simple or straightforward. There are many <a href="http://blog.startifact.com/posts/older/a-history-of-python-packaging.html">blog posts</a>, good <a href="http://pyvideo.org/video/1601/twisted-history-of-python-packaging">talks at pycon</a>, and a variety of other sources to learn about the details. Some day I may even take a shot at a summary here. But for now, we're going to bypass all the history and jump straight to building a current <code>setup.py</code> for our package.</p>

<p>That said, let's take the <a href="https://github.com/pypa/sampleproject/blob/master/setup.py">basic setup.py</a> and mold it to our purposes. I've inlined our basic version below:</p>

<p>``` python
from setuptools import setup, find_packages                                   <br/>
import codecs                                                                 <br/>
import os                                                                     <br/>
import re</p>

<p>def find_version(*file_paths):</p>

<pre><code># Open in Latin-1 so that we avoid encoding errors.                         
# Use codecs.open for Python 2 compatibility                                
here = os.path.abspath(os.path.dirname(__file__))                           
with codecs.open(os.path.join(here, *file_paths), 'r', 'latin1') as f:      
    version_file = f.read()                                                 

# The version line must have the form                                          
# __version__ = 'ver'                                                       
version_match = re.search(r"^__version__ = ['\"]([^'\"]*)['\"]",            
                          version_file, re.M)                               
if version_match:                                                           
    return version_match.group(1)                                           
raise RuntimeError("Unable to find version string.")                        
</code></pre>

<h1>Get the long description from the relevant file</h1>

<p>with codecs.open('DESCRIPTION.rst', encoding='utf-8') as f:</p>

<pre><code>long_description = f.read()                                                 
</code></pre>

<p>setup(</p>

<pre><code>name="rss2sms",                                                             
version=find_version('rss2sms', '__init__.py'),                             
description="An sms alerter for updates to an rss feed",                    
long_description=long_description,                                          
url='http://github.com/striglia/rss2sms',                                   
author='Scott Triglia',                                                     
author_email='scott.triglia@gmail.com',                                     
license='MIT',                                    

classifiers=[                                                               
    'Development Status :: 3 - Alpha',                                      
    'License :: OSI Approved :: MIT License',                               

    'Programming Language :: Python :: 2',                                  
    'Programming Language :: Python :: 2.6',                                
    'Programming Language :: Python :: 2.7',                                
],                                                                          
keywords='rss sms alerts',                                                  

packages=find_packages(exclude=["tests*"]),                                 
install_requires=[                                                          
    'feedparser',                                                           
    'tinyurl',                                                              
    'twilio',                                                               
],                                                                          
entry_points={                                                              
    'console_scripts': [                                                    
        'rss2sms=rss2sms:main',                                             
    ],                                                                      
},                                                                          
</code></pre>

<p>)                                        <br/>
```</p>

<p>Before we move on, let's make a brief note of the <code>install_requires</code> directive.</p>

<p>```
install_requires=[</p>

<pre><code>    'feedparser',                                                           
    'tinyurl',                                                              
    'twilio',                                                               
],
</code></pre>

<p>```</p>

<p>This is where our package can specify all the other python packages it depends on to work. In my original script, I just blindly imported things and assumed they were available. In this new way, we can specify what we need and python will automatically install them when we install our package.</p>

<h2>One last thing</h2>

<p>And final feature I'd like to add, even though it's not in the sample package, is a Makefile. You might be wondering why we need a Makefile at all here. Truth is, we don't really need one. The project is not that complicated and we don't need to actually build any dependencies to run the code.</p>

<p>That said, I like Makefiles as a generic interface to standard tasks for the package. In our case, I'd like there to be simple, implementation-agnostic commands to clean the project up and to run our tests.</p>

<p>This is pretty cheap to do with a Makefile. In fact, we can add this simple Makefile to do what I just described:</p>

<p>```
~/Desktop/github/rss2sms (master) $ cat Makefile
clean:</p>

<pre><code>find ./ -name "*.pyc" -delete
</code></pre>

<p>test:</p>

<pre><code>py.test tests
</code></pre>

<p>```</p>

<p>Nothing complicated here yet, but it gives us the room to expand later on. Note that I am using the excellent <a href="http://pytest.org/latest/">py.test package</a> to do my testing. I'm sure I'll talk more about how much I like it later, but you should definitely check it out in the meantime.</p>

<h2>Wrapping Up</h2>

<p>With that, we're basically set. We have the core package structure down, and we can try to install our package locally. Let's test it out:</p>

<p>```
~/Desktop/github/rss2sms (master) $ virtualenv venv
New python executable in venv/bin/python
Installing Setuptools..............................................................................................................................................................................................................................done.
Installing Pip.....................................................................................................................................................................................................................................................................................................................................done.</p>

<p> ~/Desktop/github/rss2sms (master) $ source venv/bin/activate</p>

<p> (venv) ~/Desktop/github/rss2sms (master) $ python setup.py develop
 running develop
running egg_info
writing requirements to rss2sms.egg-info/requires.txt
writing rss2sms.egg-info/PKG-INFO
writing top-level names to rss2sms.egg-info/top_level.txt
writing dependency_links to rss2sms.egg-info/dependency_links.txt
writing entry points to rss2sms.egg-info/entry_points.txt
reading manifest file 'rss2sms.egg-info/SOURCES.txt'
writing manifest file 'rss2sms.egg-info/SOURCES.txt'
running build_ext
Creating /Users/striglia/Desktop/github/rss2sms/venv/lib/python2.7/site-packages/rss2sms.egg-link (link to .)
Adding rss2sms 0.0.1 to easy-install.pth file
Installing rss2sms script to /Users/striglia/Desktop/github/rss2sms/venv/bin</p>

<p><many more lines of text here></p>

<p>Installed /Users/striglia/Desktop/github/rss2sms/venv/lib/python2.7/site-packages/httplib2-0.8-py2.7.egg
Finished processing dependencies for rss2sms==0.0.1
```</p>

<p>Success! We have a package we can install locally, which knows about its dependencies (courtesy of setup.py) and which has very rudimentary testing and documentation. In future iterations of this series, I hope to jump into a lot of interesting topics - particularly better testing setups, simple invocations of our script from the command line, and even uploading to pypi. Until then, you can find all the code described <a href="https://github.com/striglia/rss2sms/tree/v0.0.1">here on my github</a>, under the tagged version 0.0.1 of rss2sms.</p>
]]></content>
  </entry>
  
</feed>
